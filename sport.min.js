var Sports={getSports:function(){var t=[];for(var e in Sport.sports)Sport.sports[e].displayed&&t.push({value:e,label:Sport.sports[e].label});return t},sports:{"default":{label:"Default fieldset",displayed:!1,viewport:{width:450,height:250},field:[{type:"rect",x:25,y:25,width:400,height:200,"stroke-width":0,fill:"white"},{type:"text",x:225,y:125,text:"Veuillez choisir un sport en premier"}],maxPlayers:0,playerRadius:0,shapes:{ball:{strokerColor:"black",fill:"black",selectedColor:"white",radius:"14 / 2",style:"circle"}}},handball:{label:"Handball",displayed:!0,viewport:{width:450,height:250},field:[{type:"rect",x:25,y:25,width:400,height:200,fill:"0-#f1da36-#FCF6BF:50-#f1da36",fill:"#f1dF45"},{type:"path",path:"M25,50 C105,50 105,200 25,200z",fill:"#5599EE"},{type:"path",path:"M45,25 C140,25 140,225 45,225","stroke-dasharray":["- "]},{type:"path",path:"M425,50 C345,50 345,200 425,200z",fill:"#5599EE"},{type:"path",path:"M405,25 C310,25 310,225 405,225","stroke-dasharray":["- "]},{type:"path",path:"M225,25 L225,225"},{type:"path",path:"M65,124 L65,126"},{type:"path",path:"M385,124 L385,126"},{type:"path",path:"M95,120 L95,130"},{type:"path",path:"M355,120 L355,130"},{type:"rect",x:20,y:110,width:5,height:30,fill:"#ff0000"},{type:"rect",x:10,y:110,width:10,height:30,fill:"transparent"},{type:"rect",x:425,y:110,width:5,height:30,fill:"#ff0000"},{type:"rect",x:430,y:110,width:10,height:30,fill:"transparent"}],maxPlayers:7,playerRadius:7,shapes:{playerTeam1:{strokerColor:"black",fill:"red",selectedColor:"black",radius:10,style:"circle"},playerTeam2:{strokerColor:"black",fill:"green",selectedColor:"black",radius:10,style:"circle"},ball:{strokerColor:"black",fill:"white",selectedColor:"white",radius:"14 / 2",style:"circle"}}},"foot-en-salle":{label:"Foot en salle",displayed:!0,viewport:{width:350,height:200},field:[{type:"rect",x:0,y:0,width:350,height:200,"stroke-width":0,fill:"green"},{type:"rect",x:25,y:25,width:300,height:150,stroke:"white","stroke-width":2,fill:"green"},{type:"rect",x:25,y:60,width:40,height:80,stroke:"white","stroke-width":2,fill:"green"},{type:"rect",x:285,y:60,width:40,height:80,stroke:"white","stroke-width":2,fill:"green"},{type:"path",stroke:"white","stroke-width":2,path:"M175,25 L175,175"},{type:"rect",x:10,y:85,width:15,height:30,stroke:"white","stroke-width":2,fill:"transparent"},{type:"rect",x:325,y:85,width:15,height:30,stroke:"white","stroke-width":2,fill:"transparent"},{type:"circle",cx:175,cy:100,r:4,fill:"white","stroke-width":0},{type:"circle",cx:85,cy:100,r:2,fill:"white","stroke-width":0},{type:"circle",cx:265,cy:100,r:2,fill:"white","stroke-width":0}],maxPlayers:5,playerRadius:7,shapes:{playerTeam1:{strokerColor:"black",fill:"red",selectedColor:"black",radius:10,style:"circle"},playerTeam2:{strokerColor:"black",fill:"yellow",selectedColor:"black",radius:10,style:"circle"},ball:{strokerColor:"black",fill:"orange",selectedColor:"white",radius:"14 / 2",style:"circle"}}},football:{label:"Football",displayed:!0,viewport:{width:1050,height:650},field:[{type:"rect",x:0,y:0,width:1050,height:650,"stroke-width":0,fill:"green"},{type:"rect",x:25,y:25,width:1e3,height:600,stroke:"white","stroke-width":3,fill:"green"},{type:"path",stroke:"white","stroke-width":3,path:"M525,25 L525,625"},{type:"circle",cx:135,cy:325,r:91,stroke:"white","stroke-width":3},{type:"circle",cx:915,cy:325,r:91,stroke:"white","stroke-width":3},{type:"circle",cx:525,cy:325,r:91,stroke:"white","stroke-width":3},{type:"rect",x:25,y:125,width:165,height:400,stroke:"white",fill:"green","stroke-width":3},{type:"rect",x:860,y:125,width:165,height:400,stroke:"white",fill:"green","stroke-width":3},{type:"rect",x:25,y:225,width:55,height:200,stroke:"white",fill:"green","stroke-width":3},{type:"rect",x:970,y:225,width:55,height:200,stroke:"white","stroke-width":3},{type:"rect",x:1,y:289,width:24,height:73,stroke:"white","stroke-width":3},{type:"rect",x:1024,y:289,width:24,height:73,stroke:"white","stroke-width":3},{type:"circle",cx:525,cy:325,r:7,fill:"white","stroke-width":0},{type:"circle",cx:135,cy:325,r:7,fill:"white","stroke-width":0},{type:"circle",cx:915,cy:325,r:7,fill:"white","stroke-width":0}],maxPlayers:11,playerRadius:10,shapes:{playerTeam1:{strokerColor:"black",fill:"red",selectedColor:"black",radius:10,style:"circle"},playerTeam2:{strokerColor:"black",fill:"black",selectedColor:"black",radius:10,style:"circle"},ball:{strokerColor:"black",fill:"orange",selectedColor:"white",radius:"14 / 2",style:"circle"}}}}};window.S=Sports;var W=function(){this.sport=void 0,this.fieldSet={},this.shapeSet={},this.currentStepIndex=-1,this.steps=[]};W.prototype.clear=function(){this.fieldSet.forEach(function(t,e,r){t.remove()}),this.fieldSet.clear(),this.shapeSet.forEach(function(t,e,r){t.remove()}),this.shapeSet.clear()},W.prototype.initialise=function(t,e,r,i){paper=new Raphael(t,e,r),this.fieldSet=paper.set(),this.shapeSet=paper.set(),currentSport=null!==S.sports[i]&&void 0!==S.sports[i]?i:this.sport,null!==S.sports[currentSport]&&void 0!==S.sports[currentSport]?this.initialiseWorskpace(currentSport):this.initialiseWorskpace("default")},W.prototype.initialiseWorskpace=function(t){this.clear(),this.sport=t,paper.setViewBox(0,0,S.sports[this.sport].viewport.width,S.sports[this.sport].viewport.height,!0),this.fieldSet=paper.add(S.sports[this.sport].field),this.initialiseShapeSet()},W.prototype.initialiseShapeSet=function(){var t=this.sport;if(null!==t&&void 0!==t){var e=3*S.sports[t].playerRadius,r=S.sports[this.sport].viewport.width,i=S.sports[t].maxPlayers*e/2+25,s=1,l=this,p=function(){this.ox=this.attr("cx"),this.oy=this.attr("cy"),s=document.getElementById("canvas").offsetWidth/r},o=function(t,e){this.attr({cx:this.ox+t/s,cy:this.oy+e/s})},h=function(){l.shapeSet.forEach(function(t,e,r){t.id===this.id&&t.attr(this.attr)}),l.updateStep(l.currentStepIndex)};this.shapeSet=paper.set();for(var a=0;a<S.sports[t].maxPlayers;a+=1){var c=paper.circle(i+3*a*S.sports[t].playerRadius,2*S.sports[t].playerRadius+25,S.sports[t].playerRadius).attr({fill:S.sports[t].shapes.playerTeam1.fill,stroke:S.sports[t].shapes.playerTeam1.strokerColor}).drag(o,p,h);this.shapeSet.push(c)}for(var a=0;a<S.sports[t].maxPlayers;a+=1){var c=paper.circle(i+3*a*S.sports[t].playerRadius,5*S.sports[t].playerRadius+25,S.sports[t].playerRadius).attr({fill:S.sports[t].shapes.playerTeam2.fill,stroke:S.sports[t].shapes.playerTeam2.strokerColor}).drag(o,p,h);this.shapeSet.push(c)}var n=paper.circle(S.sports[t].viewport.width/2,S.sports[t].viewport.height/2,S.sports[t].playerRadius/1.5).attr({fill:S.sports[t].shapes.ball.fill,stroke:S.sports[t].shapes.ball.strokerColor}).drag(o,p,h);this.shapeSet.push(n),0===this.steps.length&&this.addStep()}else this.error="Sport not defined. Please choose first a sport in the available sports' list.",console.error(this.error)},W.prototype.updateFieldSet=function(t){this.steps=[],this.initialiseWorskpace(t)},W.prototype.exportData=function(){return JSON.stringify({sport:this.sport,title:this.title,description:this.description,steps:this.steps})},W.prototype.importData=function(t){try{this.clear(),this.title=t.title,this.description=t.description,this.initialiseWorskpace(t.sport),this.steps=t.steps,this.goToStep(0)}catch(e){console.error(e),this.error=e.message}return JSON.stringify(this.steps)},W.prototype.addStep=function(){this.steps.push(JSON.parse(JSON.stringify(this.getObjectValueForAKey(this.shapeSet.items,"attrs")))),this.currentStepIndex=this.steps.length-1},W.prototype.getStep=function(t){return t>this.steps.length||0>t?null:this.steps[t]},W.prototype.updateStep=function(t){t<this.steps.length&&(this.steps[t]=JSON.parse(JSON.stringify(this.getObjectValueForAKey(this.shapeSet.items,"attrs"))))},W.prototype.deleteStep=function(t){this.steps.splice(t,1),this.goToStep(t===this.steps.length?t-1:t)},W.prototype.deleteCurrentStep=function(){this.deleteStep(this.currentStepIndex)},W.prototype.getStepsLength=function(){return this.steps.length},W.prototype.goToStep=function(t){var e=this.getStep(t),r=0;if(null!==e&&void 0!==e){for(var i=0;i<e.length;i++)this.shapeSet[i].animate(Raphael.animation(e[i],r));this.currentStepIndex=t}},W.prototype.playStep=function(t){var e=this.getStep(t),r=0===t?100:1500,i=this;if(null!==e&&void 0!==e){this.currentStepIndex=t;var s=this.shapeSet[0],l=Raphael.animation(e[0],r,"linear",function(){i.playStep(t+1)});s.animate(l);for(var p=1;p<e.length;p++)this.shapeSet[p].animateWith(s,l,Raphael.animation(e[p],r))}},W.prototype.play=function(){this.playStep(0)},W.prototype.previousStep=function(){this.goToStep(this.currentStepIndex-1)},W.prototype.nextStep=function(){this.goToStep(this.currentStepIndex+1)},W.prototype.getObjectValueForAKey=function(t,e){var r=[];return null!==t&&void 0!==t&&t.forEach(function(t,i,s){r.push(t[e])}),r};