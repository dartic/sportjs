var Sports={getSports:function(){var t=[];for(var e in Sports.sports)Sports.sports[e].displayed&&t.push({value:e,label:Sports.sports[e].label});return t},sports:{"default":{label:"Default fieldset",displayed:!1,viewport:{width:450,height:250},field:[{type:"rect",x:25,y:25,width:400,height:200,"stroke-width":0,fill:"white"},{type:"text",x:225,y:125,text:"Ceci est la zone d'édition de votre exercice. \n - \nVeuillez choisir un sport en premier."}],maxPlayers:0,playerRadius:0,shapes:{ball:{strokerColor:"black",fill:"black",selectedColor:"white",radius:"14 / 2",style:"circle"}}},handball:{label:"Handball",displayed:!0,viewport:{width:450,height:250},field:[{type:"rect",x:25,y:25,width:400,height:200,fill:"0-#f1da36-#FCF6BF:50-#f1da36",fill:"#f1dF45"},{type:"path",path:"M25,50 C105,50 105,200 25,200z",fill:"#5599EE"},{type:"path",path:"M45,25 C140,25 140,225 45,225","stroke-dasharray":["- "]},{type:"path",path:"M425,50 C345,50 345,200 425,200z",fill:"#5599EE"},{type:"path",path:"M405,25 C310,25 310,225 405,225","stroke-dasharray":["- "]},{type:"path",path:"M225,25 L225,225"},{type:"path",path:"M65,124 L65,126"},{type:"path",path:"M385,124 L385,126"},{type:"path",path:"M95,120 L95,130"},{type:"path",path:"M355,120 L355,130"},{type:"rect",x:20,y:110,width:5,height:30,fill:"#ff0000"},{type:"rect",x:10,y:110,width:10,height:30,fill:"transparent"},{type:"rect",x:425,y:110,width:5,height:30,fill:"#ff0000"},{type:"rect",x:430,y:110,width:10,height:30,fill:"transparent"}],maxPlayers:7,playerRadius:7,shapes:{playerTeam1:{strokerColor:"black",fill:"red",selectedColor:"black",radius:10,style:"circle"},playerTeam2:{strokerColor:"black",fill:"green",selectedColor:"black",radius:10,style:"circle"},ball:{strokerColor:"black",fill:"white",selectedColor:"white",radius:"14 / 2",style:"circle"}}},"foot-en-salle":{label:"Foot en salle",displayed:!0,viewport:{width:350,height:200},field:[{type:"rect",x:0,y:0,width:350,height:200,"stroke-width":0,fill:"green"},{type:"rect",x:25,y:25,width:300,height:150,stroke:"white","stroke-width":2,fill:"green"},{type:"rect",x:25,y:60,width:40,height:80,stroke:"white","stroke-width":2,fill:"green"},{type:"rect",x:285,y:60,width:40,height:80,stroke:"white","stroke-width":2,fill:"green"},{type:"path",stroke:"white","stroke-width":2,path:"M175,25 L175,175"},{type:"rect",x:10,y:85,width:15,height:30,stroke:"white","stroke-width":2,fill:"transparent"},{type:"rect",x:325,y:85,width:15,height:30,stroke:"white","stroke-width":2,fill:"transparent"},{type:"circle",cx:175,cy:100,r:4,fill:"white","stroke-width":0},{type:"circle",cx:85,cy:100,r:2,fill:"white","stroke-width":0},{type:"circle",cx:265,cy:100,r:2,fill:"white","stroke-width":0}],maxPlayers:5,playerRadius:7,shapes:{playerTeam1:{strokerColor:"black",fill:"red",selectedColor:"black",radius:10,style:"circle"},playerTeam2:{strokerColor:"black",fill:"yellow",selectedColor:"black",radius:10,style:"circle"},ball:{strokerColor:"black",fill:"orange",selectedColor:"white",radius:"14 / 2",style:"circle"}}},football:{label:"Football",displayed:!0,viewport:{width:1050,height:650},field:[{type:"rect",x:0,y:0,width:1050,height:650,"stroke-width":0,fill:"green"},{type:"rect",x:25,y:25,width:1e3,height:600,stroke:"white","stroke-width":3,fill:"green"},{type:"path",stroke:"white","stroke-width":3,path:"M525,25 L525,625"},{type:"circle",cx:135,cy:325,r:91,stroke:"white","stroke-width":3},{type:"circle",cx:915,cy:325,r:91,stroke:"white","stroke-width":3},{type:"circle",cx:525,cy:325,r:91,stroke:"white","stroke-width":3},{type:"rect",x:25,y:125,width:165,height:400,stroke:"white",fill:"green","stroke-width":3},{type:"rect",x:860,y:125,width:165,height:400,stroke:"white",fill:"green","stroke-width":3},{type:"rect",x:25,y:225,width:55,height:200,stroke:"white",fill:"green","stroke-width":3},{type:"rect",x:970,y:225,width:55,height:200,stroke:"white","stroke-width":3},{type:"rect",x:1,y:289,width:24,height:73,stroke:"white","stroke-width":3},{type:"rect",x:1024,y:289,width:24,height:73,stroke:"white","stroke-width":3},{type:"circle",cx:525,cy:325,r:7,fill:"white","stroke-width":0},{type:"circle",cx:135,cy:325,r:7,fill:"white","stroke-width":0},{type:"circle",cx:915,cy:325,r:7,fill:"white","stroke-width":0}],maxPlayers:11,playerRadius:10,shapes:{playerTeam1:{strokerColor:"black",fill:"red",selectedColor:"black",radius:10,style:"circle"},playerTeam2:{strokerColor:"black",fill:"black",selectedColor:"black",radius:10,style:"circle"},ball:{strokerColor:"black",fill:"orange",selectedColor:"white",radius:"14 / 2",style:"circle"}}}}},W=function(){this.elementId=void 0,this.interactive=!1,this.state=void 0,this.sport=void 0,this.paper=void 0,this.fieldSet={},this.shapeSet={},this.currentStepIndex=-1,this.steps=[]};W.prototype.clear=function(){this.fieldSet&&this.fieldSet.forEach(function(t,e,r){t.remove()}),this.fieldSet.clear(),this.shapeSet&&this.shapeSet.forEach(function(t,e,r){t.remove()}),this.shapeSet.clear(),this.steps=[]},W.prototype.initialise=function(t,e){if(null===document.getElementById(t)||void 0===document.getElementById(t))throw new Error("Element with id "+t+" doesn't exist. Please check this first. Initialisation of workspace aborted.");this.elementId=t,this.interactive=e.interactive?e.interactive:!1;var r=e.width?e.width:"100%",i=e.height?e.height:"100%",s=e.sport,o=e.steps;void 0===this.paper?(this.paper=new Raphael(this.elementId,r,i),this.fieldSet=this.paper.set(),this.shapeSet=this.paper.set()):console.log("initialisation déjà faite pour élément "+t),currentSport=null!==Sports.sports[s]&&void 0!==Sports.sports[s]?s:this.sport,null!==Sports.sports[currentSport]&&void 0!==Sports.sports[currentSport]?this.initialiseWorskpace(currentSport,o):this.initialiseWorskpace("default")},W.prototype.initialiseWorskpace=function(t,e){if(!Sports.sports[t])throw new Error("Sport '"+t+"' doesn't exist in our availables sports.");this.clear(),this.sport=t,this.paper.setViewBox(0,0,Sports.sports[this.sport].viewport.width,Sports.sports[this.sport].viewport.height,!0),this.fieldSet=this.paper.add(Sports.sports[this.sport].field),this.initialiseShapeSet(e)},W.prototype.initialiseShapeSet=function(t){var e=this.sport;if(null!==e&&void 0!==e){var r=3*Sports.sports[e].playerRadius,i=Sports.sports[this.sport].viewport.width,s=Sports.sports[e].maxPlayers*r/2+25,o=1,p=this,h=function(){this.ox=this.attr("cx"),this.oy=this.attr("cy"),o=document.getElementById(p.elementId).offsetWidth/i},l=function(t,e){this.attr({cx:this.ox+t/o,cy:this.oy+e/o})},a=function(){p.shapeSet.forEach(function(t,e,r){t.id===this.id&&t.attr(this.attr)}),p.updateStep(p.currentStepIndex)};this.shapeSet=this.paper.set();for(var n=0;n<Sports.sports[e].maxPlayers;n+=1){var c=this.paper.circle(s+3*n*Sports.sports[e].playerRadius,2*Sports.sports[e].playerRadius+25,Sports.sports[e].playerRadius).attr({fill:Sports.sports[e].shapes.playerTeam1.fill,stroke:Sports.sports[e].shapes.playerTeam1.strokerColor});this.interactive&&(c=c.drag(l,h,a)),this.shapeSet.push(c)}for(var n=0;n<Sports.sports[e].maxPlayers;n+=1){var c=this.paper.circle(s+3*n*Sports.sports[e].playerRadius,5*Sports.sports[e].playerRadius+25,Sports.sports[e].playerRadius).attr({fill:Sports.sports[e].shapes.playerTeam2.fill,stroke:Sports.sports[e].shapes.playerTeam2.strokerColor});this.interactive&&(c=c.drag(l,h,a)),this.shapeSet.push(c)}var d=this.paper.circle(Sports.sports[e].viewport.width/2,Sports.sports[e].viewport.height/2,Sports.sports[e].playerRadius/1.5).attr({fill:Sports.sports[e].shapes.ball.fill,stroke:Sports.sports[e].shapes.ball.strokerColor});this.interactive&&(d=d.drag(l,h,a)),this.shapeSet.push(d),t&&void 0!==t&&t.length>0&&(this.steps=t,this.goToStep(0)),0===this.steps.length&&"default"!==this.sport&&this.addStep()}else this.error="Sport not defined. Please choose first a sport in the available sports' list.",console.error(this.error)},W.prototype.updateFieldSet=function(t){t!==this.sport&&window.confirm("Are you sure to switch from "+this.sport+" to "+t+" ? ")&&this.initialiseWorskpace(t)},W.prototype.exportData=function(){return JSON.stringify({sport:this.sport,steps:this.steps})},W.prototype.importData=function(t){try{this.initialiseWorskpace(t.sport,t.steps),this.steps&&this.steps.length>0&&this.goToStep(0)}catch(e){console.error(e),this.error=e.message}return JSON.stringify(this.steps)},W.prototype.addStep=function(){this.steps.push(JSON.parse(JSON.stringify(this.getObjectValueForAKey(this.shapeSet.items,"attrs")))),this.triggerEvent("stepAdded"),this.currentStepIndex=this.steps.length-1},W.prototype.getStep=function(t){return t>this.steps.length||0>t?null:this.steps[t]},W.prototype.updateStep=function(t){t<this.steps.length&&(this.steps[t]=JSON.parse(JSON.stringify(this.getObjectValueForAKey(this.shapeSet.items,"attrs")))),this.triggerEvent("stepUpdated")},W.prototype.deleteStep=function(t){this.steps.splice(t,1),this.triggerEvent("stepDeleted"),this.goToStep(t===this.steps.length?t-1:t)},W.prototype.deleteCurrentStep=function(){this.deleteStep(this.currentStepIndex)},W.prototype.getStepsLength=function(){return this.steps?this.steps.length:0},W.prototype.goToStep=function(t){var e=this.getStep(t),r=0;if(null!==e&&void 0!==e){for(var i=0;i<e.length;i++)this.shapeSet[i].animate(Raphael.animation(e[i],r));this.currentStepIndex=t,this.triggerEvent("currentStepIndexChanged")}},W.prototype.playStep=function(t,e){var r=this.getStep(t),i=0===t?100:1500,s=this;if(null!==r&&void 0!==r){this.currentStepIndex=t;var o=this.shapeSet[0],p=Raphael.animation(r[0],i,"linear",function(){e&&e(),s.playStep(t+1,e)});o.animate(p);for(var h=1;h<r.length;h++)this.shapeSet[h].animateWith(o,p,Raphael.animation(r[h],i))}},W.prototype.play=function(t){this.playStep(0,t)},W.prototype.previousStep=function(){this.goToStep(this.currentStepIndex-1)},W.prototype.nextStep=function(){this.goToStep(this.currentStepIndex+1)},W.prototype.getObjectValueForAKey=function(t,e){var r=[];return null!==t&&void 0!==t&&t.forEach(function(t,i,s){r.push(t[e])}),r},W.prototype.triggerEvent=function(t){var e=new Event(t,{bubbles:!0});document.getElementById(this.elementId).dispatchEvent(e)};